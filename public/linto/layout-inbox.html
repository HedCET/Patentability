<dom-module id="layout-inbox">

    <style>
    paper-drawer-panel /deep/ #drawer,
    paper-drawer-panel /deep/ #main #scrim {
        z-index: 1;
    }
    
    paper-fab {
        --paper-fab-background: var(--paper-red-500);
        --paper-fab-keyboard-focus-background: var(--paper-red-700);
    }
    
    paper-toolbar .title {
        padding: 0 8px;
    }
    
    paper-toolbar paper-icon-button {
        margin: 0!important;
    }
    
    paper-toolbar .selection-visible {
        padding: 0;
        transform: rotateX(90deg);
        transition: transform 400ms ease-in-out;
        visibility: hidden;
        width: 0;
        will-change: transform;
    }
    
    paper-toolbar paper-icon-button[icon="arrow-back"] {
        transform: translateX(-42px);
    }
    
    paper-toolbar.selection .selection-hidden {
        display: none;
    }
    
    paper-toolbar.selection .selection-visible {
        padding: 8px;
        transform: rotateX(0);
        visibility: visible;
        width: auto;
    }
    
    paper-toolbar.selection paper-icon-button[icon="arrow-back"] {
        transform: translateX(0);
    }
    
    .menu-b {
        bottom: 12px;
        position: fixed;
        right: 16px;
        -webkit-transition: -webkit-transform 0.2s ease-in-out;
        transition: transform 0.2s ease-in-out;
        will-change: transform;
    }
    
    .menu-b.move-down {
        transform: translate3d(0, 80px, 0)!important;
    }
    </style>

    <template>


        <paper-drawer-panel id="paper_drawer_panel">
            <paper-header-panel drawer>
                <iron-selector>
                    <paper-icon-item class="cursor-p hover relative">
                        <div item-icon>
                            <selectable-icon icon_img_src="/img/github.png"></selectable-icon>
                        </div>
                        <paper-item-body two-line>
                            <div>open source</div>
                            <div secondary>build break develop</div>
                        </paper-item-body>
                        <paper-ripple></paper-ripple>
                    </paper-icon-item>

                    <paper-icon-item class="cursor-p hover relative">
                        <div item-icon>
                            <selectable-icon icon_class="red-500" icon_text="W"></selectable-icon>
                        </div>
                        <paper-item-body two-line>
                            <div>what happened ? long keyword ..</div>
                            <div secondary>build break develop</div>
                        </paper-item-body>
                        <paper-ripple></paper-ripple>
                    </paper-icon-item>
                </iron-selector>
            </paper-header-panel>

            <paper-header-panel main>
                <paper-toolbar class="teal-500" id="toolBar">
                    <paper-icon-button class="selection-visible" icon="arrow-back" on-tap="clear_list_selection"></paper-icon-button>
                    <paper-icon-button class="selection-hidden" icon="menu" on-tap="menuToggle"></paper-icon-button>

                    <div class="title" id="toolBarTitle"></div>

                    <paper-icon-button class="selection-visible" icon="delete"></paper-icon-button>
                    <paper-icon-button class="selection-visible" icon="social:share"></paper-icon-button>
                    <paper-icon-button class="selection-visible" icon="more-vert"></paper-icon-button>
                    <paper-icon-button class="selection-hidden" icon="search" on-tap="search"></paper-icon-button>
                </paper-toolbar>

                <neon-animated-pages class="fit" selected="[[main_page]]">
                    <neon-animatable class="center-center layout vertical">
                        <div>how to use ?</div>
                    </neon-animatable>
                    <neon-animatable class="layout vertical">


                        <div class="center-justified horizontal layout">
                            <div class="li">
                                <iron-selector attr-for-selected="item" multi selectable="inbox-item" selected-attribute="selected" selected-values="{{list_selected}}">
                                    <div class="bordered center horizontal justified layout">
                                        <div class="cursor-d etc" style="padding: 16px;">what happened ? long keyword .. | what happened ? long keyword ..</div>
                                        <paper-icon-button icon="close" on-tap="delete"></paper-icon-button>
                                    </div>
                                    <template is="dom-repeat" items="[[list]]">
                                        <inbox-item item="[[item]]" data-id$="[[index]]"></inbox-item>
                                    </template>
                                </iron-selector>
                                <div style="min-height: 80px;"></div>
                            </div>
                        </div>
                    </neon-animatable>
                </neon-animated-pages>
            </paper-header-panel>
        </paper-drawer-panel>

        <paper-fab class="menu-b" id="fab" icon="add" on-tap="addItem"></paper-fab>


        <search-bar id="searchBar"></search-bar>

        <paper-toast class="cursor-d horizontal justified layout" duration="4000" id="layout_inbox_toast" on-transitionend="layout_inbox_toast" style="font-size: 14px; margin-right: 12px; padding: 16px; z-index: 1;" text="">
            <div class="cursor-p self-start" id="undo" hidden style="color: #FFEB3B; margin-left: 8px;">UNDO</div>
        </paper-toast>
    </template>

    <script>
    Polymer({

        addItem: function() {
            this.toast("what happened ? long keyword ..");
        },

        clear_list_selection: function() {
            this.list_selected = [];
        },

        is: "layout-inbox",

        layout_inbox_toast: function(e) {
            if (this.$.layout_inbox_toast.visible) {
                this.$.fab.translate3d(0, "-" + ($("#layout_inbox_toast #label").height() + 46) + "px", 0);
            } else {
                this.$.fab.translate3d(0, 0, 0);

                console.log("undoOverFlow");
            }
        },

        menuToggle: function() {
            if (this.$.paper_drawer_panel.narrow && $(this.$.paper_drawer_panel).width() <= parseInt(this.$.paper_drawer_panel.responsiveWidth)) {
                this.$.paper_drawer_panel.togglePanel();
            } else {
                this.$.paper_drawer_panel.forceNarrow = !this.$.paper_drawer_panel.forceNarrow;
            }
        },

        observers: [
            "_listSelectedChanged(list_selected.splices)"
        ],

        properties: {
            list: {
                type: Array,
                value: function() {
                    return [{
                        count: "8H",
                        keyword: "patent title"
                    }, {
                        count: "8",
                        keyword: "semantic search engine to check patentability which map one concept to other relative concept"
                    }, {
                        count: "2",
                        keyword: "HedCET"
                    }, {
                        count: "16",
                        keyword: "Malayalam Movie"
                    }, {
                        count: "8",
                        keyword: "US 8320578 B2"
                    }];
                }
            },
            list_selected: {
                type: Array,
                value: function() {
                    return [];
                }
            },
            main_page: {
                type: Number,
                value: 1
            }
        },

        ready: function() {},

        search: function() {
            this.$.searchBar.toggle();
        },

        toast: function(text) {
            this.$.layout_inbox_toast.hide();

            this.async(function() {
                this.$.layout_inbox_toast.text = text;
                this.$.layout_inbox_toast.show();
            }, 400);
        },

        _listSelectedChanged: function(change) {
            this.$.toolBarTitle.textContent = (this.list_selected.length ? this.list_selected.length : "patentability store");

            this.$.toolBar.toggleClass("grey-500", this.list_selected.length);
            this.$.toolBar.toggleClass("selection", this.list_selected.length);

            this.$.fab.toggleClass("move-down", this.list_selected.length);
        }

    });
    </script>

</dom-module>
