<dom-module id="inbox-item">

    <template>
        <template if="[[item]]" is="dom-if">
            <paper-icon-item class="bg-white bordered cursor-p hover relative" on-tap="paperIconItemTap">
                <div item-icon>
                    <selectable-icon icon_img_src$="[[icon_src(item.p_no)]]" id="selector" selected$="[[selected]]"></selectable-icon>
                </div>

                <paper-item-body two-line style="margin-right: 0; min-height: 0; padding: 14px 0;">
                    <div class="lowercase" style="white-space: normal;">[[item.title]]</div>
                    <div class="center horizontal justified layout" secondary>
                        <div class="etc lowercase">[[assigneeFormat(item.assignee)]]</div>
                        <div>[[fromNow(item.app_date)]]</div>
                    </div>
                </paper-item-body>

                <!-- <paper-ripple></paper-ripple> -->
            </paper-icon-item>
        </template>
    </template>

    <script>
    Polymer({

        assigneeFormat: function(assignee) {
            return assignee.replace(/;/g, ", ");
        },

        fromNow: function(time) {
            return moment(time, ["YYYY-MM-DD"]).fromNow().replace("s ago", " old");
        },

        icon_src: function(text) {
            return "/img/40/" + (text.match(/^[A-Z]{2}/) ? text.match(/^[A-Z]{2}/) : "_") + ".png";
        },

        is: "inbox-item",

        paperIconItemTap: function(e) {
            if (Polymer.dom(e).localTarget.id != "selector") {
                e.stopPropagation();

                console.log(this.item._id);
            }
        },

        properties: {
            item: Object,
            selected: {
                notify: true,
                reflectToAttribute: true,
                type: Boolean,
                value: false
            }
        }

    });
    </script>

</dom-module>
